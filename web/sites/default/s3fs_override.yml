services:
  # Override the public stream wrapper
  stream_wrapper.public:
    class: Drupal\s3fs\StreamWrapper\S3fsStream
    tags:
      - { name: stream_wrapper, scheme: public }

  # Override the private stream wrapper
  stream_wrapper.private:
    class: Drupal\s3fs\StreamWrapper\S3fsStream
    tags:
      - { name: stream_wrapper, scheme: private }

  # Override core file storage service
  file.storage:
    class: Drupal\s3fs\S3fsFileStorage
    arguments: ["@stream_wrapper_manager", "@file_system", "@kernel", "@lock"]
